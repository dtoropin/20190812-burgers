const $=document.querySelector.bind(document),$$=document.querySelectorAll.bind(document);!function(){const e=document.querySelector(".hamburger"),t=document.querySelector(".nav-mobile__list"),n=document.querySelector(".accordion"),o=document.querySelectorAll(".accordion__item"),i=document.querySelector(".accordion-menu"),c=document.querySelectorAll(".accordion-menu__item"),s=document.querySelector(".reviews__list"),a=document.querySelector("#popupReviews"),l=document.querySelector(".popup__close"),r=document.querySelector(".delivery-form"),u=document.querySelector("#popupMessage"),d=document.querySelector(".popup__mes-close"),m=document.querySelector(".slider__control"),p=document.querySelector(".slider__content");let v=0;const f=[{latitude:59.973495,longitude:30.310718,hintContent:"улица Чапыгина, 11"},{latitude:59.945932,longitude:30.380769,hintContent:"Калужский переулок, 7"},{latitude:59.887203,longitude:30.313387,hintContent:"Заставская улица, 46к2"},{latitude:59.91527,longitude:30.49351,hintContent:"улица Подвойского, 33к2"}];let g=function(){e.addEventListener("click",function(e){e.preventDefault(),_()}),t.addEventListener("click",function(e){"nav-mobile__link"==e.target.className&&_()}),n.addEventListener("click",function(e){"accordion__head"==e.target.className&&(e.preventDefault(),L(e))}),i.addEventListener("click",function(e){e.preventDefault(),e.target.classList.contains("accordion-menu__link")&&y(e),e.target.classList.contains("accordion-menu__close")&&E(e.target.parentElement)}),s.addEventListener("click",function(e){if("A"==e.target.tagName){e.preventDefault();let t=e.target.parentElement.firstElementChild,n=t.nextElementSibling;w(t.innerHTML,n.innerHTML)}}),l.addEventListener("click",function(e){e.preventDefault(),E(a)}),r.addEventListener("submit",function(e){e.preventDefault();let t=new FormData;t.append("name",e.target.elements.name.value),t.append("phone",e.target.elements.phone.value),t.append("comment",e.target.elements.comment.value),t.append("to","denis.toropin@yandex.ru");let n=new XMLHttpRequest;n.open("POST","https://webdev-api.loftschool.com/sendmail"),n.responseType="json",n.send(t),n.addEventListener("load",()=>{n.status>=400?S("Что-то пошло не так..."):S(n.response.message)}),e.target.reset()}),d.addEventListener("click",function(e){e.preventDefault(),E(u)}),m.addEventListener("click",function(e){e.preventDefault(),e.target.classList.contains("slider__arrow--left")&&h("right"),e.target.classList.contains("slider__arrow--right")&&h("left")})},_=function(){e.classList.toggle("active")},L=function(e){o.forEach(function(t){t!==e.target.parentElement&&t.classList.remove("active")}),e.target.parentElement.classList.toggle("active")},y=function(e){c.forEach(function(t){t!==e.target.parentElement&&t.classList.remove("active")}),e.target.parentElement.classList.toggle("active")},E=function(e){e.classList.remove("active")},w=function(e,t){a.classList.add("active"),document.querySelector(".popup__title").innerHTML=e,document.querySelector(".popup__text").innerHTML=t},S=function(e){u.classList.add("active"),document.querySelector(".popup__mes-text").innerHTML=e},h=function(e){let t=document.querySelector(".vision");"right"===e&&t.previousElementSibling&&(v+=100,p.style.transform=`translateX(${v}%)`,t.previousElementSibling.classList.add("vision"),t.classList.remove("vision")),"left"===e&&t.nextElementSibling&&(v-=100,p.style.transform=`translateX(${v}%)`,t.nextElementSibling.classList.add("vision"),t.classList.remove("vision"))},q=function(){let e=[],t=new ymaps.Map("map",{center:[59.923055,30.385391],zoom:11,controls:["zoomControl"],behaviors:["drag"]});for(let t=0;t<f.length;t++)e[t]=new ymaps.Placemark([f[t].latitude,f[t].longitude],{hintContent:f[t].hintContent},{iconLayout:"default#image",iconImageHref:"images/sprite.svg#map-marker",iconImageSize:[46,46],iconImageOffset:[-23,-46]});let n=new ymaps.Clusterer({zoomMargin:50});t.geoObjects.add(n),n.add(e),t.geoObjects.events.add("click",function(e){var n=e.get("target").geometry.getCoordinates();t.setCenter(n,17)})};g(),ymaps.ready(q)}(),function(){const e=document.querySelectorAll(".section"),t=document.querySelector(".main-content"),n=document.querySelectorAll(".navpage__item"),o=document.querySelectorAll("[data-scroll-to]"),i=document.querySelector(".hamburger"),c=document.querySelectorAll(".popup");let s=!1;const a=function(){document.addEventListener("wheel",r),document.addEventListener("keydown",u),o.forEach(function(e){e.addEventListener("click",m)})};let l=function(e){swipe_det=new Object,swipe_det.sX=0,swipe_det.sY=0,swipe_det.eX=0,swipe_det.eY=0;var t="";ele=document.querySelector("body"),ele.addEventListener("touchstart",function(e){var t=e.touches[0];swipe_det.sX=t.screenX,swipe_det.sY=t.screenY},!1),ele.addEventListener("touchmove",function(e){e.preventDefault();var t=e.touches[0];swipe_det.eX=t.screenX,swipe_det.eY=t.screenY},!1),ele.addEventListener("touchend",function(n){(swipe_det.eY-30>swipe_det.sY||swipe_det.eY+30<swipe_det.sY)&&swipe_det.eX<swipe_det.sX+30&&swipe_det.sX>swipe_det.eX-30&&swipe_det.eY>0&&(t=swipe_det.eY>swipe_det.sY?"down":"up"),""==t||d()||"function"==typeof e&&e(t),t="",swipe_det.sX=0,swipe_det.sY=0,swipe_det.eX=0,swipe_det.eY=0},!1)},r=function(e){if(d())return!1;let t=e.deltaY>0?"up":"down";p(t)},u=function(e){switch(e.keyCode){case 40:p("up");break;case 38:p("down")}},d=function(){let e=!1;return i.classList.contains("active")&&(e=!0),c.forEach(function(t){t.classList.contains("active")&&(e=!0)}),e},m=function(e){e.preventDefault(),g(e.target.dataset.scrollTo)},p=function(e){let t=v();if("up"===e&&t.next){let e=t.index+1;g(e)}if("down"===e&&t.prev){let e=t.index-1;g(e)}},v=function(){for(let t=0;t<e.length;t++)if(e[t].classList.contains("is-active"))return{index:t,active:e[t],next:e[t].nextElementSibling,prev:e[t].previousElementSibling}},f=function(e,t){e[t].classList.add("is-active");for(const n of e)n!=e[t]&&n.classList.remove("is-active")},g=function(o){let i=`${-100*o}%`;s||(s=!0,f(e,o),t.style.transform=`translateY(${i})`,f(n,o),setTimeout(()=>{s=!1},700))};a(),l(p)}();const videoModule=function(){const e=document.getElementById("video"),t=document.querySelectorAll(".play"),n=document.querySelector(".video__play"),o=document.getElementById("videoDuration"),i=document.getElementById("videoVolume"),c=document.getElementById("soundOnOff");let s;const a=function(){e.addEventListener("click",l),t.forEach(function(e){e.addEventListener("click",l)}),c.addEventListener("click",u),i.addEventListener("click",d),i.addEventListener("mousedown",d),o.addEventListener("mousedown",m),o.addEventListener("click",p)};let l=function(){n.classList.toggle("active"),o.max=e.duration,e.paused?(e.play(),s=setInterval(r,15)):(e.pause(),clearInterval(s))},r=function(){o.value=e.currentTime},u=function(){0===e.volume?(e.volume=soundLevel,i.value=10*soundLevel):(soundLevel=e.volume,e.volume=0,i.value=0)},d=function(){e.volume=i.value/10},m=function(){e.pause(),clearInterval(s)},p=function(){e.paused?e.play():e.pause(),e.currentTime=o.value,s=setInterval(r,15)};return{init:function(){a(),o.min=0,o.value=0,i.min=0,i.max=10,i.value=i.max}}}();document.addEventListener("DOMContentLoaded",videoModule.init());